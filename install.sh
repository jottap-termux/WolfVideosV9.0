#!/data/data/com.termux/files/usr/bin/bash

# Cores ANSI
green="\033[1;32m"
red="\033[1;31m"
yellow="\033[1;33m"
blue="\033[1;34m"
cyan="\033[1;36m"
reset="\033[0m"

# Banner COMPLETO (exatamente como no original)
banner="

              ‚¢∂                                   ‚°æ‚°Ä
             ‚¢∞‚£Ñ‚¢∑‚°Ä                               ‚¢Ä‚°æ‚£°‚†á
             ‚¢∞‚†ô‚£¶‚°ô‚¢¶‚°Ä      ‚°Ä‚£Ñ‚°Ä ‚°¥‚†∏‚£Ñ ‚£†‚†é‚¢¶ ‚¢Ä‚£†‚¢Ä      ‚¢Ä‚°¥‚¢ã‚£¥‚†è‚°Ü
             ‚£æ ‚†ò‚¢Ø‚£¶‚£â‚°≥‚†¶‚£Ñ‚°æ‚†∂‚†Ñ‚†õ‚¢Ñ‚†â‚£ô‚†Å‚£Ü‚£å‚†∂‚¢É‚£∞‚†à‚¢õ‚†â‚††‚†ö‚†¢‚†∂‚†ø‚£†‚†§‚†û‚£ã‚¢¥‚°ø‚†ã ‚£∑
             ‚£ø‚¢† ‚†à‚¢ª‚°ª‚£Ω‚£∂‚£¶‚£Ñ‚††‚£Ñ‚†ï‚£§‚£¢‚£û‚£∑‚°ú‚£ø‚£∂‚£ø‚¢ß‚£æ‚£∑‚£ó‚£§‚†™‚¢Ä‚†Ñ‚£†‚£¥‚£∂‚£ü‚£ü‚°ü‚†Å ‚¢†‚£ø
            ‚¢†‚°ø‚°∏‚°Ç  ‚†ì‚†ò‚¢¶ ‚†Å‚†Å‚†ò‚£¶‚¢™‚¢ø‚£ø‚£ø‚†ª‚£ø‚£ø‚£ø‚†ü‚£ø‚£ø‚£ø‚°µ‚£¥‚†É‚†ò‚†â‚†ê‚°µ‚†ã‚†û  ‚¢Ä‚¢á‚£ª‚°Ü
            ‚¢∏‚°á‚£ß‚°Ä   ‚†Ñ‚†ò‚£ß   ‚†∏‚£ø‚£ø‚£ø‚£ø‚£á‚†ò‚£ø‚†É‚£∏‚£ø‚£ø‚£ø‚£ø‚†á   ‚£º‚†É    ‚†ò‚¢º‚°∏‚°á
            ‚¢∏‚†Å‚¢ø‚°≥     ‚†ò‚£ß‚°ò‚£¶‚£∑‚£ª‚¢ø‚°ø‚£ø‚£ø‚£ß ‚£∞‚£ø‚£ø‚¢ø‚°ø‚£ø‚£º‚£¥‚£á‚£º‚†É    ‚¢Ä‚†û‚£ø ‚°á
          ‚¢Ä‚°Ä‚¢∏‚°Ä‚°à‚¢∑‚†Ñ  ‚†Ñ‚£≤‚£∂‚£æ‚°ø‚†ø‚¢ù‚†ø‚¢∑‚°ï‚†∏‚°ø‚£ø‚¢∑‚£ø‚£Ø‚°è‚¢™‚°æ‚†´‚£ª‚†ø‚¢ø‚£∑‚£∂‚£ñ‚†¢   ‚°æ‚¢É ‚°á‚¢Ä‚°Ä
          ‚†à‚¢Ø‚°õ‚†Å‚†ò    ‚°¥‚£ñ‚£ö‚£ø‚£ß‚£Ñ‚††‚°Ä ‚†π‚£Ü‚¢≥‚†â ‚†â‚°û‚£†‚†è ‚¢Ä‚†Ñ‚£†‚£º‚£ø‚£ì‚£í‚†¶    ‚†Ç‚°à‚†õ‚°ø‚†Å
          ‚¢Ä‚°¥‚¢ã‚£§‚£§‚°ñ‚†ã‚†Å ‚£†‚£¥‚£ü‚¢ø‚°ø‚£ø‚£ø‚£Ω‚£¶‚£Ñ‚†à‚†é‚†£ ‚†ò‚†±‚†Å‚¢†‚£¥‚£Ø‚£ø‚£ø‚¢ø‚°ø‚£ø‚£¶‚£Ñ ‚†à‚†õ‚£∂‚£¶‚£Ñ‚°ò‚¢¶‚°Ä
         ‚††‚¢ü‚°ñ‚¢Ä‚£§‚°§‚†î‚†Ç‚††‚†º‚¢ø‚°°‚†å‚†Å‚†à‚°Ä‚†ª‚£ù‚£ø‚£ø‚£Ü‚°Ü   ‚¢†‚£¥‚£ø‚£ø‚¢ø‚†ü‚¢Å‚†Å‚†à ‚¢â‚°ø‚†∑‚†Ñ‚†ê‚†¢‚†§‚£§‚°Ä‚¢≤‚°õ‚†Ñ
          ‚°û‚†ê‚°ª‚†â    ‚£Ä‚°¨  ‚°§‚°Ä‚†ª‚£¶‚°Ä‚†ô‚£ø‚°ø‚†á   ‚†∏‚¢ø‚£ø‚†É‚¢Å‚£¥‚°ü‚¢Ä‚£§  ‚¢•‚£Ñ    ‚†â‚¢ù‚†Ç‚¢ª
         ‚¢∞‚¢á‚£º‚£ß‚¢æ‚£Ω‚°Ç‚¢†‚£æ‚†ø‚¢ø‚£ø‚£ß‚£ù‚£ø‚£¶‚£Ñ    ‚††‚£¥‚£Ä‚£¶‚°§    ‚£Ä‚£¥‚£ü‚£´‚£¥‚£ø‚£ø‚†ø‚£∑‚£Ñ‚¢Ä‚¢Æ‚°∑‚¢Æ‚£ß‚°ò‚£á
        ‚¢Ä‚£ø‚°ö‚†â‚†ê‚£©‚°Ø‚†ñ‚¢Ä‚£§‚¢Ü‚°Ä ‚†â‚†õ‚¢ª‚°≠  ‚†≤‚¢Æ‚£Ω‚£¶‚†∏‚£ø‚†è‚£¥‚£è‚°Ω‚†ñ  ‚¢π‚°ü‚†õ‚†ã  ‚°∞‚£§‚°Ñ‚†∞‚¢Ω‚£ç‚†Ç‚†â‚¢õ‚£ø‚°Ñ
        ‚†â‚†â‚£† ‚¢ö‚°≠‚†Ç ‚¢â‚£æ‚°ø‚†â   ‚¢†‚°∂‚¢ø‚£∑‚£ø‚£¶‚†∏‚†ø‚†≥‚†â‚†û‚†ø‚†è‚£¥‚£ø‚£æ‚°ø‚¢∂‚£Ñ   ‚†®‚¢ø‚£∑‚°ç ‚†ê‚¢Æ‚°ì‚†Ñ‚£Ñ‚†â‚†â
          ‚°è‚°¥‚¢ã‚£î‚†Ñ  ‚°ü ‚°¥‚£æ  ‚°è ‚¢∞‚£ø‚¢ø‚°á‚†ê‚†ä‚†ª‚£ø‚†ü‚†â‚†Ç‚¢π‚£ø‚£ø‚°û ‚†∏‚°Ñ ‚¢≥‚¢¶ ‚¢ª  ‚††‚°¢‚°ô‚¢¶‚£π
         ‚¢Ä‚†ü‚°Ä‚¢∏‚£ø‚†ä  ‚†É ‚†Å‚°è‚°Ü  ‚†ê‚¢å‚†ª‚£ü‚£ß‚°Ä     ‚¢Ä‚£º‚£≥‚°ü‚°°‚†Ç  ‚¢∞‚¢ø‚†à‚†Ç‚†à  ‚†ë‚£Ω‚°á‚¢Ä‚†ª‚°Ä
           ‚°á‚¢∏‚°ß  ‚°Ä   ‚†Å‚¢ü‚£Ü  ‚††‚°ì‚¢Ω‚°ø‚°ó‚†Ü   ‚††‚¢æ‚¢ü‚°ø‚¢ä‚†Ö ‚¢†‚£∏‚°ª‚†à   ‚¢Ä  ‚¢æ‚°á‚¢∏
           ‚°á‚†à‚£†‚°é‚£æ‚†Ñ‚†∞‚°Å‚†Ñ  ‚†à‚¢ª‚°Ä  ‚†Å         ‚†à‚°Ä ‚¢Ä‚°æ‚†Å   ‚£Ä‚†Ü ‚£≥‚¢∞‚£Ñ‚†Å‚¢∏
           ‚¢π‚£∞‚†ã‚£ß‚†ü‚¢Ä‚¢Ä‚£ø‚°î‚¢∞‚†á  ‚†Å  ‚£ø ‚°á‚¢∞‚¢† ‚°Ü‚°Ü‚¢∏ ‚£∑‚†Å ‚†à  ‚†ê‚°Ü‚¢¢‚£ª‚°Ä‚°Ä‚†ª‚£∏‚†ô‚£Ü‚°û
           ‚†ò‚†á ‚†∏‚°Ñ‚°æ‚£Ü‚†ª‚°á‚†ò ‚¢Ä   ‚¢Ä‚†π         ‚†è    ‚°Ä ‚†É‚¢∏‚†ü‚£∞‚£ø‚¢Ä‚†è ‚†∏‚†É
               ‚¢ª‚†Å‚£ø ‚£¥ ‚¢∏‚¢∫   ‚†ò ‚¢∏       ‚°á ‚°á   ‚¢≥‚°Ñ ‚£∂ ‚¢π‚†à‚°ü
                 ‚¢∏‚°ú‚†π‚†≥‚£å‚£ø‚°Ñ  ‚¢á ‚¢ª‚¢†     ‚°Ñ‚°Ø ‚¢∞  ‚¢†‚£ø‚¢°‚†û‚†è‚¢ß‚°è
                  ‚†Å  ‚†à‚†´‚¢≥‚£î‚¢†  ‚°å‚†à‚†ã‚†É‚†Ç‚†ò‚†â‚†Å‚¢Å  ‚°Ñ‚£§‚°û‚†ù‚†Å  ‚†à
                        ‚†ô‚¢∂‚°Ü‚£¶‚†à‚†ì‚†í‚†í‚†í‚†í‚†í‚†ö‚†Å‚£∞‚¢†‚£µ‚†ã
                          ‚†ô‚†ò‚¢ß‚°à‚¢æ‚£¥‚£æ‚£¶‚†∂‚¢É‚°º‚†É‚†ã
                             ‚†ô‚¢¶‚°à‚†õ‚¢É‚°¥‚†ã
                               ‚†ô‚¢∂‚†ã


                ‚£∞‚£¶‚°Ä       ‚¢†‚°Ñ  ‚°∞‚£∂‚£≤‚£§  ‚¢∞‚°∂ ‚£†‚£¥‚£∂‚£∂‚£¥‚£í
                ‚¢ª‚£ø‚°á  ‚£§‚£∑   ‚£º‚°á ‚°ü‚°ü‚†â‚†â‚¢ª‚£Ü ‚¢∏‚°á ‚£ø‚£ø‚°á
                ‚¢®‚£ø‚£á  ‚¢ª‚£ø  ‚¢Ä‚£ø‚†Å‚¢∏‚°Ø   ‚¢∏‚£ø ‚£∫‚°á ‚†∏‚£ø‚£ø‚°ø‚†ø‚†õ
                 ‚¢ø‚£ø‚°Ä‚¢Ä‚£æ‚¢ø‚£¶ ‚£º‚°á ‚†∏‚°á   ‚£∏‚°ø ‚£∫‚†Ö  ‚£ø‚°á
                 ‚†à‚£ø‚£á‚£æ‚†á‚†à‚£ø‚£ø‚°ü   ‚†Ø‚¢∂‚£∂‚†æ‚†ü‚†Å ‚¢ø‚£¶‚°∂‚†Ñ‚¢π‚†á    ìÉ¶·®íÍ®ÑÔ∏é üêæ
                  ‚†ò‚¢ø‚†è  ‚†à‚†õ‚†Å


        ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñë
        ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë  ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë
        ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë  ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë
        ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñë ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë  ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë
        ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë  ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë
        ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë      ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë  ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë
        ‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñì‚ñí‚ñë‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë  ‚ñë‚ñí‚ñì‚ñà‚ñì‚ñí‚ñë
"

# Fun√ß√£o para verificar conex√£o com a internet
check_internet() {
  echo -e "${yellow}Verificando conex√£o com a internet...${reset}"
  if ! ping -c 1 google.com &> /dev/null; then
    echo -e "${red}Erro: Sem conex√£o com a internet!${reset}"
    echo -e "${yellow}Por favor, conecte-se √† internet e tente novamente.${reset}"
    exit 1
  fi
}

# Fun√ß√£o barra de progresso melhorada
progress_bar() {
  local task="$1"
  local cmd="$2"
  local color="$3"
  local cols=30
  local i=0
  local delay=0.08

  echo -ne "${color}${task}...${reset}"

  bash -c "$cmd" &> /dev/null &
  local pid=$!

  while kill -0 $pid 2> /dev/null; do
    i=$(( (i+1) % (cols+1) ))
    printf "\r${color}${task}... [%s] %3d%%" \
           "$(printf '%0.s‚ñà' $(seq 1 $i))$(printf '%0.s‚ñë' $(seq $((i+1)) $cols))" \
           $((i*100/cols))
    sleep $delay
  done

  wait $pid
  local status=$?

  if [ $status -eq 0 ]; then
    printf "\r${color}${task}... [$(printf '%0.s‚ñà' $(seq 1 $cols))] 100%% ${green}sucesso [‚úî]${reset}\n"
  else
    printf "\r${color}${task}... [$(printf '%0.s‚ñà' $(seq 1 $cols))] 100%% ${red}falhou [‚úò]${reset}\n"
    echo -e "${red}Erro no comando: ${cmd}${reset}"
    exit 1
  fi
}

# Fun√ß√£o principal
main() {
  clear
  echo -e "${cyan}$banner${reset}"
  echo -e "${yellow}Iniciando instala√ß√£o das depend√™ncias do Wolf no Termux...${reset}"

  check_internet

  # Atualizar e instalar pacotes
  progress_bar "Atualizando pacotes" "pkg update -y && pkg upgrade -y" "$green"
  progress_bar "Instalando Python" "pkg install python -y" "$green"
  progress_bar "Instalando FFmpeg" "pkg install ffmpeg -y" "$green"
  progress_bar "Instalando utilit√°rios" "pkg install wget git aria2 -y" "$green"
  progress_bar "Instalando yt-dlp" "pip install --upgrade yt-dlp" "$green"
  progress_bar "Instalando requests" "pip install --upgrade requests" "$green"

  # Configurar armazenamento
  echo -e "\n${blue}Configurando permiss√£o de armazenamento...${reset}"
  if termux-setup-storage; then
    echo -e "${green}Permiss√£o concedida com sucesso!${reset}"
  else
    echo -e "${yellow}Aviso: N√£o foi poss√≠vel configurar o armazenamento automaticamente${reset}"
    echo -e "${yellow}Voc√™ pode tentar manualmente depois executando: termux-setup-storage${reset}"
  fi

  # Mensagem final
  echo -e "\n${green}Todas as depend√™ncias foram instaladas com sucesso!${reset}"
  echo -e "${cyan}Agora voc√™ pode executar o Wolf com: ${yellow}python3 wolf-9.0.py${reset}"
  echo -e "${blue}üê∫ Divirta-se com o Wolf! ${reset}"
}

# Executa a fun√ß√£o principal
main
